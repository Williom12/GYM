<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>GYM</title>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>

body{
margin:0;
background:#000;
color:white;
font-family:-apple-system,BlinkMacSystemFont,system-ui;
overflow:hidden;
}

/* HEADER */
header{
background:#0c0c0c;
text-align:center;
padding:18px;
font-size:24px;
font-weight:700;
letter-spacing:2px;
}

/* MENU */
.menu{
display:flex;
flex-wrap:wrap;
justify-content:center;
gap:8px;
padding:10px;
background:#111;
}

button{
background:#1a1a1a;
color:white;
border:none;
padding:10px 14px;
border-radius:10px;
cursor:pointer;
}

button:active{ transform:scale(.95); }

/* SCREEN SYSTEM */

#screen{
position:relative;
height:calc(100vh - 120px);
overflow:hidden;
}

.view{
position:absolute;
width:100%;
height:100%;
overflow-y:auto;
padding:20px;
box-sizing:border-box;
}

.enter{ animation:in .35s ease forwards; }
.exit{ animation:out .35s ease forwards; }

@keyframes in{
from{transform:translateX(40px);opacity:0}
to{transform:translateX(0);opacity:1}
}

@keyframes out{
from{transform:translateX(0);opacity:1}
to{transform:translateX(-40px);opacity:0}
}

/* CENTER */
.center{
display:flex;
flex-direction:column;
justify-content:center;
align-items:center;
height:100%;
gap:20px;
}

.perfilBtn{
width:220px;
padding:15px;
font-size:18px;
border-radius:14px;
background:#111;
}

.card{
background:#111;
padding:14px;
margin:12px 0;
border-radius:14px;
}

input{
background:#0f0f0f;
border:1px solid #333;
color:white;
padding:6px;
width:70px;
border-radius:6px;
margin:5px;
}

.save{
background:#00aa66;
padding:14px;
border-radius:12px;
margin-top:15px;
width:100%;
font-weight:bold;
}

.hidden{display:none}
.pr{color:#00ff9f;font-weight:bold}

</style>
</head>

<body>

<header>GYM üí™</header>

<div id="menu" class="menu hidden">
<button onclick="home()">Inicio</button>
<button onclick="abrirDia(1)">D1</button>
<button onclick="abrirDia(2)">D2</button>
<button onclick="abrirDia(3)">D3</button>
<button onclick="abrirDia(4)">D4</button>
<button onclick="abrirDia(5)">D5</button>
<button onclick="historial()">Historial</button>
<button onclick="progreso()">Progreso</button>
</div>

<div id="screen"></div>

<script>

/* ---------- VIEW SYSTEM ---------- */

let currentView=null;

function cambiarVista(html){

const screen=document.getElementById("screen");

const nueva=document.createElement("div");
nueva.className="view";
nueva.innerHTML=html;

if(currentView){
currentView.classList.add("exit");
setTimeout(()=>currentView.remove(),300);
}

screen.appendChild(nueva);

requestAnimationFrame(()=>{
nueva.classList.add("enter");
});

currentView=nueva;
}

/* ---------- DATA ---------- */

let perfil="";
let diaActual=null;

const rutina={
1:["Press inclinado","Fondos","Aperturas","Press cerrado","Extensi√≥n tr√≠ceps"],
2:["Dominadas","Remo barra","Jal√≥n pecho","Peso muerto rumano","Curl barra","Curl inclinado"],
3:["Sentadilla","Prensa","Curl femoral","Extensi√≥n cu√°driceps","Gemelos"],
4:["Press militar","Elevaciones laterales","Elevaciones posteriores","Encogimientos","Crunch peso"],
5:["Press banca","Dominadas","Remo mancuerna","Curl + Extensi√≥n"]
};

const key=d=>perfil+"_dia_"+d;

/* ---------- PERFIL ---------- */

function perfilScreen(){
cambiarVista(`
<div class="center">
<h2>Selecciona Perfil</h2>
<button class="perfilBtn" onclick="setPerfil('William')">William</button>
<button class="perfilBtn" onclick="setPerfil('JuanManuel')">Juan Manuel</button>
</div>
`);
}

function setPerfil(p){
perfil=p;
menu.classList.remove("hidden");
home(); /* ahora entra al inicio */
}

/* ---------- HOME ---------- */

function home(){
cambiarVista(`
<div class="center">
<h2>Bienvenido ${perfil}</h2>
<p>Selecciona un d√≠a para entrenar üí™</p>
</div>
`);
}

/* ---------- DIA ---------- */

function abrirDia(d){

diaActual=d;

let html=`<h2>Dia ${d}
<input type="date" id="fecha_${d}">
</h2>`;

rutina[d].forEach((e,i)=>{
html+=`
<div class="card">
${e}<br>
KG <input id="kg_${d}_${i}">
Reps <input id="rep_${d}_${i}">
<span id="pr_${d}_${i}" class="pr"></span>
</div>`;
});

html+=`<button class="save" onclick="guardar()">Guardar ‚úÖ</button>`;

cambiarVista(html);

setTimeout(()=>{
cargar(d);
mostrarPR(d);
},80);
}

/* ---------- SAVE ---------- */

function guardar(){

let d=diaActual;

let data={
fecha:document.getElementById(`fecha_${d}`).value,
ej:[]
};

rutina[d].forEach((_,i)=>{
data.ej.push({
kg:Number(document.getElementById(`kg_${d}_${i}`).value)||0,
rep:document.getElementById(`rep_${d}_${i}`).value
});
});

localStorage.setItem(key(d),JSON.stringify(data));
alert("Guardado ‚úÖ");
}

/* ---------- LOAD ---------- */

function cargar(d){
let info=localStorage.getItem(key(d));
if(!info)return;

info=JSON.parse(info);

document.getElementById(`fecha_${d}`).value=info.fecha;

info.ej.forEach((e,i)=>{
document.getElementById(`kg_${d}_${i}`).value=e.kg;
document.getElementById(`rep_${d}_${i}`).value=e.rep;
});
}

/* ---------- PR ---------- */

function mostrarPR(d){

rutina[d].forEach((_,i)=>{

let max=0;

for(let x=1;x<=5;x++){
let data=localStorage.getItem(key(x));
if(data){
data=JSON.parse(data);
if(data.ej[i])
max=Math.max(max,data.ej[i].kg);
}
}

if(max>0)
document.getElementById(`pr_${d}_${i}`).textContent=`üèÜ ${max}kg`;

});
}

/* ---------- HISTORIAL ---------- */

function historial(){

let html="<h2>Historial</h2>";

for(let d=1;d<=5;d++){
let data=localStorage.getItem(key(d));
if(data){
data=JSON.parse(data);

html+=`
<div class="card">
Dia ${d}<br>
Fecha: ${data.fecha}<br><br>
<button onclick="abrirDia(${d})">Abrir</button>
<button onclick="eliminarDia(${d})">Eliminar</button>
</div>`;
}
}

cambiarVista(html);
}

function eliminarDia(d){
if(confirm("Eliminar d√≠a?")){
localStorage.removeItem(key(d));
historial();
}
}

/* ---------- GRAFICO ---------- */

function progreso(){

cambiarVista(`<h2>Progreso üìà</h2><canvas id="chart"></canvas>`);

setTimeout(()=>{

let labels=[];
let valores=[];

for(let d=1;d<=5;d++){
let data=localStorage.getItem(key(d));
if(data){
data=JSON.parse(data);
let total=0;
data.ej.forEach(e=>total+=e.kg);
labels.push("Dia "+d);
valores.push(total);
}
}

new Chart(chart,{
type:"line",
data:{labels,datasets:[{label:"Peso total",data:valores,tension:.3}]},
options:{
plugins:{legend:{labels:{color:"white"}}},
scales:{x:{ticks:{color:"white"}},y:{ticks:{color:"white"}}}
}
});

},120);
}

/* START */
perfilScreen();

</script>

</body>
</html>
