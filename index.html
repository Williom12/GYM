<!DOCTYPE html>
<html lang="es">
<head>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>GYM</title>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#000000">

<!-- CHART.JS (graficas) -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>

*{box-sizing:border-box;-webkit-tap-highlight-color:transparent;}

body{
background:#000;
color:#fff;
font-family:Arial;
margin:0;
display:flex;
justify-content:center;
}

.app{
width:100%;
max-width:500px;
min-height:100vh;
}

header{
background:#111;
padding:18px;
text-align:center;
font-size:22px;
font-weight:bold;
position:sticky;
top:0;
}

.streak{
position:absolute;
right:15px;
top:18px;
}

.menu{
display:flex;
flex-wrap:wrap;
gap:8px;
padding:12px;
background:#111;
justify-content:center;
}

button{
background:#222;
color:white;
border:none;
padding:12px;
border-radius:10px;
flex:1 1 30%;
font-size:15px;
}

.container{
padding:18px;
}

input{
background:#111;
border:1px solid #444;
color:white;
padding:10px;
width:70px;
margin:4px;
border-radius:8px;
}

.card{
background:#111;
padding:16px;
border-radius:12px;
margin:12px 0;
}

.hidden{display:none;}

canvas{
background:#111;
border-radius:12px;
padding:10px;
}

</style>
</head>

<body>

<div class="app">

<header>
GYM üí™
<span id="racha" class="streak">0 üî•</span>
</header>

<div id="perfilSelect" class="container">
<h2>Selecciona perfil</h2>
<button onclick="seleccionarPerfil('William')">William</button>
<button onclick="seleccionarPerfil('JuanManuel')">Juan Manuel</button>
</div>

<div id="menu" class="menu hidden">
<button onclick="mostrarDia(1)">Dia 1</button>
<button onclick="mostrarDia(2)">Dia 2</button>
<button onclick="mostrarDia(3)">Dia 3</button>
<button onclick="mostrarDia(4)">Dia 4</button>
<button onclick="mostrarDia(5)">Dia 5</button>
<button onclick="mostrarHistorial()">Historial</button>
<button onclick="mostrarProgreso()">Progreso</button>
</div>

<div class="container" id="contenido"></div>

</div>

<script>

if('serviceWorker' in navigator){
navigator.serviceWorker.register('service-worker.js');
}

let perfil="";

const rutina={
1:["Press inclinado","Fondos","Aperturas","Press cerrado","Extensi√≥n tr√≠ceps"],
2:["Dominadas","Remo barra","Jal√≥n pecho","Peso muerto rumano","Curl barra","Curl inclinado"],
3:["Sentadilla","Prensa","Curl femoral","Extensi√≥n cu√°driceps","Gemelos"],
4:["Press militar","Elevaciones laterales","Elevaciones posteriores","Encogimientos","Crunch peso"],
5:["Press banca","Dominadas","Remo mancuerna","Curl + Extensi√≥n"]
};

function resetView(){
document.getElementById("contenido").innerHTML="";
window.scrollTo(0,0); // ‚úÖ FIX MOVIL
}

function seleccionarPerfil(p){
perfil=p;
document.getElementById("perfilSelect").classList.add("hidden");
document.getElementById("menu").classList.remove("hidden");
actualizarRacha();
}

function keyDia(n){ return perfil+"_dia_"+n; }

/* -------- DIAS -------- */

function mostrarDia(n){

resetView();

let html=`<h2>Dia ${n} <input type="date" id="fecha"></h2>`;

rutina[n].forEach((e,i)=>{
html+=`<p>${e}
<input id="kg${i}" placeholder="KG">
Reps <input id="rep${i}">
</p>`;
});

html+=`<button onclick="guardarDia(${n})">Guardar</button>`;

contenido.innerHTML=html;

cargarDia(n);
}

function guardarDia(n){

let datos={
fecha:fecha.value,
ejercicios:[]
};

rutina[n].forEach((_,i)=>{
datos.ejercicios.push({
kg:document.getElementById("kg"+i).value,
rep:document.getElementById("rep"+i).value
});
});

localStorage.setItem(keyDia(n),JSON.stringify(datos));
actualizarRacha();
alert("Guardado ‚úÖ");
}

function cargarDia(n){

let datos=localStorage.getItem(keyDia(n));
if(!datos) return;

datos=JSON.parse(datos);

fecha.value=datos.fecha;

datos.ejercicios.forEach((e,i)=>{
kg0?.value;
document.getElementById("kg"+i).value=e.kg;
document.getElementById("rep"+i).value=e.rep;
});
}

/* -------- RACHA -------- */

function actualizarRacha(){
let total=0;
for(let i=1;i<=5;i++){
if(localStorage.getItem(keyDia(i))) total++;
}
racha.innerText=total+" üî•";
}

/* -------- HISTORIAL -------- */

function mostrarHistorial(){

resetView();

let html="<h2>Historial</h2>";

for(let i=1;i<=5;i++){
let datos=localStorage.getItem(keyDia(i));
if(datos){
datos=JSON.parse(datos);

html+=`
<div class="card">
<b>Dia ${i}</b><br>
Fecha: ${datos.fecha}<br><br>
<button onclick="mostrarDia(${i})">Abrir</button>
<button onclick="eliminarDia(${i})">Eliminar</button>
</div>`;
}
}

contenido.innerHTML=html;
}

function eliminarDia(n){
if(confirm("¬øEliminar d√≠a?")){
localStorage.removeItem(keyDia(n));
actualizarRacha();
mostrarHistorial();
}
}

/* -------- PROGRESO + GRAFICAS -------- */

function mostrarProgreso(){

resetView();

let labels=[];
let data=[];
let totalPeso=0;

for(let i=1;i<=5;i++){

let datos=localStorage.getItem(keyDia(i));

if(datos){
datos=JSON.parse(datos);

let suma=0;

datos.ejercicios.forEach(e=>{
suma+=Number(e.kg)||0;
});

labels.push("Dia "+i);
data.push(suma);
totalPeso+=suma;
}
}

contenido.innerHTML=`
<h2>Progreso</h2>

<div class="card">üèãÔ∏è Peso total levantado: <b>${totalPeso} kg</b></div>

<canvas id="graficaPeso"></canvas>
`;

if(labels.length>0){

new Chart(document.getElementById("graficaPeso"),{
type:"line",
data:{
labels:labels,
datasets:[{
label:"Peso levantado",
data:data,
borderWidth:3,
tension:0.3
}]
},
options:{
plugins:{legend:{labels:{color:"white"}}},
scales:{
x:{ticks:{color:"white"}},
y:{ticks:{color:"white"}}
}
}
});
}
}

</script>
</body>
</html>
