<!DOCTYPE html>
<html lang="es">
<head>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">

<title>GYM</title>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#000000">

<style>

*{
box-sizing:border-box;
-webkit-tap-highlight-color: transparent;
}

body{
background:#000;
color:#fff;
font-family:Arial, sans-serif;
margin:0;
display:flex;
justify-content:center;
}

.app{
width:100%;
max-width:500px;
min-height:100vh;
display:flex;
flex-direction:column;
}

header{
background:#111;
padding:18px;
text-align:center;
font-size:22px;
font-weight:bold;
position:sticky;
top:0;
z-index:10;
}

.streak{
position:absolute;
right:15px;
top:18px;
font-size:18px;
}

.menu{
display:flex;
flex-wrap:wrap;
justify-content:center;
gap:8px;
padding:12px;
background:#111;
}

button{
background:#222;
color:white;
border:none;
padding:12px;
border-radius:10px;
cursor:pointer;
font-size:15px;
flex:1 1 30%;
min-width:90px;
}

button:active{
transform:scale(0.97);
}

.container{
padding:18px;
}

input{
background:#111;
border:1px solid #444;
color:white;
padding:10px;
width:70px;
margin:4px;
border-radius:8px;
font-size:16px;
}

.card{
background:#111;
padding:16px;
border-radius:12px;
margin:12px 0;
}

.hidden{display:none;}

h2{
text-align:center;
margin-top:0;
}

</style>
</head>

<body>

<div class="app">

<header>
GYM üí™
<span id="racha" class="streak">0 üî•</span>
</header>

<div id="perfilSelect" class="container">
<h2>Selecciona perfil</h2>
<button onclick="seleccionarPerfil('William')">William</button>
<button onclick="seleccionarPerfil('JuanManuel')">Juan Manuel</button>
</div>

<div id="menu" class="menu hidden">
<button onclick="mostrarDia(1)">Dia 1</button>
<button onclick="mostrarDia(2)">Dia 2</button>
<button onclick="mostrarDia(3)">Dia 3</button>
<button onclick="mostrarDia(4)">Dia 4</button>
<button onclick="mostrarDia(5)">Dia 5</button>
<button onclick="mostrarHistorial()">Historial</button>
<button onclick="mostrarProgreso()">Progreso</button>
</div>

<div class="container" id="contenido"></div>

</div>

<script>

/* ===== SERVICE WORKER ===== */
if('serviceWorker' in navigator){
navigator.serviceWorker.register('service-worker.js');
}

/* ===== TODO TU JS ORIGINAL (SIN CAMBIOS) ===== */

let perfil="";

const rutina={
1:["Press inclinado mancuernas","Fondos paralelas","Aperturas mancuernas","Press cerrado","Extensi√≥n tr√≠ceps polea"],
2:["Dominadas","Remo con barra","Jal√≥n al pecho","Peso muerto rumano","Curl barra","Curl inclinado"],
3:["Sentadilla libre","Prensa","Curl femoral","Extensi√≥n cu√°driceps","Gemelos de pie"],
4:["Press militar","Elevaciones laterales","Elevaciones posteriores","Encogimientos barra","Crunch con peso"],
5:["Press banca","Dominadas","Remo mancuerna","Curl + Extensi√≥n superserie"]
};

function seleccionarPerfil(p){
perfil=p;
document.getElementById("perfilSelect").classList.add("hidden");
document.getElementById("menu").classList.remove("hidden");
actualizarRacha();
}

function keyDia(n){ return perfil+"_dia_"+n; }

function limpiar(){ document.getElementById("contenido").innerHTML=""; }

function mostrarDia(n){

limpiar();

let html=`<h2>Dia ${n} <input type="date" id="fecha"></h2>`;

rutina[n].forEach((e,i)=>{
html+=`<p>${e}
<input id="kg${i}" placeholder="KG">
Reps <input id="rep${i}">
</p>`;
});

html+=`<button onclick="guardarDia(${n})">Guardar</button>`;
document.getElementById("contenido").innerHTML=html;

cargarDia(n);
}

function guardarDia(n){

let datos={
fecha:document.getElementById("fecha").value,
ejercicios:[]
};

rutina[n].forEach((_,i)=>{
datos.ejercicios.push({
kg:document.getElementById("kg"+i).value,
rep:document.getElementById("rep"+i).value
});
});

localStorage.setItem(keyDia(n),JSON.stringify(datos));
actualizarRacha();
alert("Guardado ‚úÖ");
}

function cargarDia(n){
let datos=localStorage.getItem(keyDia(n));
if(!datos) return;

datos=JSON.parse(datos);

document.getElementById("fecha").value=datos.fecha;

datos.ejercicios.forEach((e,i)=>{
document.getElementById("kg"+i).value=e.kg;
document.getElementById("rep"+i).value=e.rep;
});
}

function actualizarRacha(){
let total=0;
for(let i=1;i<=5;i++){
if(localStorage.getItem(keyDia(i))) total++;
}
document.getElementById("racha").innerText=total+" üî•";
}

function mostrarHistorial(){

limpiar();
let html="<h2>Historial</h2>";

for(let i=1;i<=5;i++){
let datos=localStorage.getItem(keyDia(i));
if(datos){
datos=JSON.parse(datos);
html+=`<div class="card">
<b>Dia ${i}</b><br>
Fecha: ${datos.fecha}<br><br>
<button onclick="mostrarDia(${i})">Abrir</button>
<button onclick="eliminarDia(${i})">Eliminar</button>
</div>`;
}
}

document.getElementById("contenido").innerHTML=html;
}

function eliminarDia(n){
if(confirm("¬øEliminar d√≠a?")){
localStorage.removeItem(keyDia(n));
actualizarRacha();
mostrarHistorial();
}
}

function mostrarProgreso(){

limpiar();

let diasEntrenados=0;
let pesoTotal=0;
let maxPeso=0;
let mejorEjercicio="Ninguno";
let totalEjercicios=0;

for(let d=1; d<=5; d++){

let datos=localStorage.getItem(keyDia(d));

if(datos){
diasEntrenados++;
datos=JSON.parse(datos);

datos.ejercicios.forEach((e,i)=>{

let kg=Number(e.kg)||0;

pesoTotal+=kg;

if(kg>0) totalEjercicios++;

if(kg>maxPeso){
maxPeso=kg;
mejorEjercicio=rutina[d][i];
}
});
}
}

let promedio = totalEjercicios>0
? (pesoTotal/totalEjercicios).toFixed(1)
: 0;

document.getElementById("contenido").innerHTML=`
<h2>Progreso</h2>
<div class="card">üìÖ D√≠as entrenados: <b>${diasEntrenados}</b></div>
<div class="card">üèãÔ∏è Peso total levantado: <b>${pesoTotal} kg</b></div>
<div class="card">üí™ Ejercicio m√°s fuerte:<br><b>${mejorEjercicio}</b><br>${maxPeso} kg</div>
<div class="card">üìä Promedio por ejercicio: <b>${promedio} kg</b></div>
<div class="card">üî• Racha actual: <b>${diasEntrenados}</b></div>`;
}

</script>
</body>
</html>
